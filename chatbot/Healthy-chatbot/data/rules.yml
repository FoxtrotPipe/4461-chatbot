version: "3.1"

rules:
- rule: Say goodbye anytime the user says goodbye
  steps:
  - intent: goodbye
  - action: utter_goodbye

- rule: Say 'I am a bot' anytime the user challenges
  steps:
  - intent: bot_challenge
  - action: utter_iamabot



## Custom rules here
# trigger the name form filling

# rule activating the form
- rule: Activate name form
  steps:
    - intent: tell_name         # whenever we see this intent appear,
    - action: utter_ask_name
    - action: name_form         # form is just like action by exist in an loop
    # active_loop means will keep requesting slots in the form
    # until the all slots value in the form is filled in (first_name, last_name in this case)          
    - active_loop: name_form


# rule handling deactivation of the form
- rule: Submit name form
  
  ##### this condition block indicate when the form is filled-in completely
  condition:                  # ensure that we are in the active loop
  - active_loop: name_form          
  steps:
    - action: name_form       # in the loop, we are running current name form
    # active_loop means 
    - active_loop: null       
    - slot_was_set: 
      - requested_slot: null     # no more slot is being request
  ##### 

  # when the form is done, we will do the following action
    - action: utter_thankyou
    - action: utter_user_name
